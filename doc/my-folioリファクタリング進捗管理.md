# my-folio リファクタリング進捗管理

## 現在の実装状況

### 使用技術
- Vue.js 3 + TypeScript
- Vite
- Pinia (状態管理)
- Vue Router
- Vuetify (UIコンポーネント)
- BabylonJS (3Dグラフィックス)
- ApexCharts (グラフ表示)

### プロジェクト構造
```
src/
├── assets/       - 静的ファイル
├── components/   - コンポーネント
│   ├── babylon/  - 3D関連コンポーネント
│   ├── global/   - グローバルコンポーネント
│   ├── home/     - ホーム画面コンポーネント
│   └── project/  - プロジェクト関連コンポーネント
├── locales/      - 多言語対応ファイル
├── plugins/      - プラグイン設定
├── router/       - ルーティング設定
├── stores/       - Piniaストア
└── views/        - 画面コンポーネント
```

### 現状の課題
1. 型安全性が不十分（`@ts-ignore`の多用）
2. i18n実装が複雑で拡張性に欠ける
3. コンポーネントの責務が大きすぎる
4. ストア実装が複雑で保守が難しい
5. 認証ロジックが未整理
6. テスト不足
7. エラーハンドリングが不十分
8. パフォーマンス最適化余地あり

## リファクタリングの範囲

### 対象外
- **babylonJS関連**: `src/components/babylon/` ディレクトリ内の3D関連コンポーネントは、専門性が高く独立した機能のため、現時点でのリファクタリング作業の対象外とします。

## リファクタリング案

### 1. 型定義の改善
- **作業ブランチ**: `refactor/improve-typescript-types`
- **目標**: TypeScriptの型安全性を高め、`@ts-ignore`を削減する
- **具体策**:
  - [ ] 翻訳データの型定義を厳密化
  - [ ] ユーティリティ型を活用した型推論の強化
  - [ ] Zod/io-tsなどのバリデーションライブラリ導入検討
  - [ ] Vueコンポーネントにおけるprops/emitsの型定義強化

### 2. 国際化（i18n）システムの改善
- **作業ブランチ**: `refactor/improve-i18n`
- **目標**: 複雑な翻訳ロジックを簡素化し保守性を高める
- **具体策**:
  - [ ] vue-i18nなど標準的なi18nライブラリの採用検討
  - [ ] 翻訳キー構造の整理と一貫性確保
  - [ ] 翻訳データのモジュール分割とオンデマンドロード
  - [ ] `t`関数のリファクタリングによる条件分岐の削減

### 3. コンポーネント設計の改善
- **作業ブランチ**: `refactor/improve-component-design`
- **目標**: 単一責任の原則に沿った再利用可能なコンポーネント構成
- **具体策**:
  - [ ] 大きなコンポーネント（特にHomeView）の分割
  - [ ] Compositionによるロジック分離の促進
  - [ ] Atomic Designパターンの適用検討
  - [ ] コンポーネント間のデータフロー最適化

### 4. ストアの構造改善
- **作業ブランチ**: `refactor/improve-store-structure`
- **目標**: データ管理の単純化と効率化
- **具体策**:
  - [ ] ストア間の依存関係の整理
  - [ ] 正規化されたデータ構造の採用
  - [ ] Composition API + Provide/Injectの活用検討
  - [ ] リアクティブ性能の最適化

### 5. ビジネスロジックとUIの分離
- **作業ブランチ**: `refactor/separate-business-logic`
- **目標**: 関心の分離を促進し、テスト容易性を向上
- **具体策**:
  - [ ] Composable関数へのロジック抽出
  - [ ] サービスレイヤーの導入
  - [ ] ドメインモデルの明確化
  - [ ] 副作用の分離と管理

### 6. テスト導入
- **作業ブランチ**: `feature/add-tests`
- **目標**: コード品質と信頼性の向上
- **具体策**:
  - [ ] Vitest/Jestによるユニットテスト導入
  - [ ] Vue Testing Libraryによるコンポーネントテスト
  - [ ] Cypress/Playwright導入によるE2Eテスト
  - [ ] Storybook導入によるUIコンポーネントのドキュメント化

### 7. エラーハンドリングの強化
- **作業ブランチ**: `feature/improve-error-handling`
- **目標**: 堅牢性と利用者体験の向上
- **具体策**:
  - [ ] グローバルエラーハンドリングの導入
  - [ ] ユーザーフレンドリーなエラー表示
  - [ ] エラーログ収集と分析
  - [ ] 回復メカニズムの実装

### 8. パフォーマンス最適化
- **作業ブランチ**: `refactor/optimize-performance`
- **目標**: 初期ロード時間の短縮とUX向上
- **具体策**:
  - [ ] コンポーネントの遅延ロード適用
  - [ ] 画像の最適化
  - [ ] バンドルサイズ分析と削減
  - [ ] メモ化による不要な再計算防止

### 9. API通信の抽象化
- **作業ブランチ**: `refactor/abstract-api-communication`
- **目標**: データフェッチングロジックの一元管理
- **具体策**:
  - [ ] APIクライアントレイヤーの導入
  - [ ] リクエスト/レスポンス型の定義
  - [ ] キャッシュ戦略の最適化
  - [ ] 通信状態の統一管理

### 10. ルーティングとナビゲーションの整理
- **作業ブランチ**: `refactor/improve-routing`
- **目標**: 画面遷移とアクセス制御の明確化
- **具体策**:
  - [ ] ルート定義の構造化
  - [ ] ナビゲーションガードの最適化
  - [ ] 認証・認可ロジックの整理
  - [ ] ルート情報のメタデータ活用

## 優先順位と実装計画

### フェーズ1（基盤改善）: 2週間
1. 型定義の改善
2. 国際化システムの改善
3. エラーハンドリングの基盤構築

### フェーズ2（構造改善）: 3週間
1. ストアの構造改善
2. コンポーネント設計の改善
3. ビジネスロジックとUIの分離

### フェーズ3（品質向上）: 2週間
1. テスト導入
2. パフォーマンス最適化
3. API通信の抽象化

### フェーズ4（完成度向上）: 1週間
1. ルーティングとナビゲーションの整理
2. ドキュメント整備
3. 最終調整

## 進捗管理

### 完了タスク
- [ ] プロジェクト現状分析
- [ ] リファクタリング計画立案

### 進行中タスク
- [ ] 型定義改善: 翻訳データの型定義厳密化

### 次のアクション
1. `language.ts`の`t`関数リファクタリング
2. コンポーネント分割の詳細設計
3. テスト環境のセットアップ

## レビューチェックリスト

リファクタリング完了時の品質確認項目:

- [ ] TypeScriptエラーがないこと
- [ ] ESLint警告がないこと
- [ ] 全テストが通過すること
- [ ] パフォーマンス指標が改善していること
- [ ] コードの重複が削減されていること
- [ ] 機能的な変更がないこと（同一動作の確認）

## 定期レビュー

週次で以下を確認:
1. 計画と実際の進捗の差異
2. 発生した課題と対応策
3. 優先順位の再評価
4. 次週の具体的な実装目標

## 参考資料

- [Vue.js スタイルガイド](https://v3.ja.vuejs.org/style-guide/)
- [TypeScript ベストプラクティス](https://typescript-jp.gitbook.io/deep-dive/styleguide)
- [Pinia ドキュメント](https://pinia.vuejs.org/)
- [コンポーネント設計パターン](https://www.patterns.dev/vue)
